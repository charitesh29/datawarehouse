CREATE OR REPLACE PROCEDURE DATA_WAREHOUSE.BRONZE.BRONZE_SCHEMA_LOAD()
RETURNS STRING
LANGUAGE SQL
AS
BEGIN

TRUNCATE TABLE DATA_WAREHOUSE.BRONZE.CRM_CUST_INFO;

COPY INTO DATA_WAREHOUSE.BRONZE.CRM_CUST_INFO
FROM
(
SELECT $1,$2,$3,$4,$5,$6,$7 
FROM @data_warehouse_modern/CRM/cust_info.csv
)
file_format='CSV_FILE_FORMAT';

TRUNCATE TABLE DATA_WAREHOUSE.BRONZE.CRM_PRD_INFO;

COPY INTO DATA_WAREHOUSE.BRONZE.CRM_PRD_INFO
FROM
(
SELECT $1,$2,$3,$4,$5,$6,$7 
FROM @data_warehouse_modern/CRM/prd_info.csv
)
file_format='CSV_FILE_FORMAT';

TRUNCATE TABLE DATA_WAREHOUSE.BRONZE.CRM_SALES_DETAILS;

COPY INTO DATA_WAREHOUSE.BRONZE.CRM_SALES_DETAILS
FROM
(
SELECT $1,$2,$3,$4,$5,$6,$7,$8,$9
FROM @data_warehouse_modern/CRM/sales_details.csv
)
file_format='CSV_FILE_FORMAT';

TRUNCATE TABLE DATA_WAREHOUSE.BRONZE.ERP_CUST_AZ12;

COPY INTO DATA_WAREHOUSE.BRONZE.ERP_CUST_AZ12
FROM
(
SELECT $1,$2,$3
FROM @data_warehouse_modern/ERP/CUST_AZ12.csv
)
file_format='CSV_FILE_FORMAT';

TRUNCATE TABLE DATA_WAREHOUSE.BRONZE.ERP_LOC_A101;

COPY INTO DATA_WAREHOUSE.BRONZE.ERP_LOC_A101
FROM
(
SELECT $1,$2
FROM @data_warehouse_modern/ERP/LOC_A101.csv
)
file_format='CSV_FILE_FORMAT';

TRUNCATE TABLE DATA_WAREHOUSE.BRONZE.ERP_PX_CAT_G1V2;

COPY INTO DATA_WAREHOUSE.BRONZE.ERP_PX_CAT_G1V2
FROM
(
SELECT $1,$2,$3,$4
FROM @data_warehouse_modern/ERP/PX_CAT_G1V2.csv
)
file_format='CSV_FILE_FORMAT';

RETURN 'TABLE LOADED SUCESSFULLY';

END;

CALL DATA_WAREHOUSE.BRONZE.BRONZE_SCHEMA_LOAD();